<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>JPromise</title>
<meta name="description" content="" />
<meta name="keywords" content="" />
<style type="text/css">
body,div,canvas,img{
    margin:0;
    padding:0;
    border:0;
}
html,body{
    height:100%;
}
#wrap{
    min-height:100%;
    position:relative;
}
.dot{
    background:red;
    border-radius:100%;
    width:30px;
    height:30px;
}
#dot1{
    -webkit-animation:fly 1s linear alternate infinite;
    -moz-animation:fly 1s linear alternate infinite;
    animation:fly 1s linear alternate infinite;
}
#dot3{
    width:60px;
    height:60px;
    margin:30px;
}
</style>
</head>
<body>
<div id="wrap">
    <h1>示例一 普通用法，js生成动画，css通过animation属性调用</h1>
    <div class="dot" id="dot1"style=""></div>
    <pre id="pre1">
    代码部分：
        css: #dot1{
                -webkit-animation:fly 1s linear alternate infinite;
                -moz-animation:fly 1s linear alternate infinite;
                animation:fly 1s linear alternate infinite;
            }

        js: new JS2CSSKeyframes('fly',{
                from:'transform:translate(0,0)',
                to:'transform:translate(100px,0)'
            });

    等同于 new JS2CSSKeyframes('fly',['transform:translate(0,0)','transform:translate(100px,0)']);
    </pre>

    <h1>示例二 通过js添加匿名动画</h1>
    <div class="dot" id="dot2"></div>
    <pre id="pre2">
    代码部分：document.querySelector('#dot1').style.cssText=JS2CSSKeyframes.vendor+'animation:'+JS2CSSKeyframes([
                    'transform:translate(0,0)',
                    'transform:translate(100px,0)'
                ]).name+' 1s linear alternate infinite';

        或者：document.querySelector('#dot1').style[JS2CSSKeyframes.animation]=JS2CSSKeyframes([
                    'transform:translate(0,0)',
                    'transform:translate(100px,0)'
                ]).name+' 1s linear alternate infinite';
    </pre>

    <h1>示例三 通过JS2CSSKeyframes生成复杂多帧复杂动画</h1>
    <div class="dot" id="dot3"></div>
    <pre id="pre3">
    代码部分：var kfs=[],num=100,rand=function(f,t){return Math.random()*t+f}
                while(num){
                    kfs.push({transform:'scale('+rand(0,2)+')',background:'rgba('+parseInt(255*Math.random())+','+parseInt(255*Math.random())+','+parseInt(255*Math.random())+','+Math.random()+')'});
                    num--;
                }
                document.querySelector('#dot3').style[JS2CSSKeyframes.animation]=JS2CSSKeyframes(kfs).name+' 60s linear alternate infinite';
    </pre>

    <h1>示例四，生成常用css3组件，见 <a href="css3-animation.js">css3-animation.js</a></h1>
    <pre id="pre4">
        ;
        (function(ROOT, undefined){
            "use strict";
            
            if(!JS2CSSKeyframes.support) return; //确保是支持css3动画的浏览器

            var styleSheet=document.styleSheets.item(0);
            var vendor=JS2CSSKeyframes.vendor;
            
            //生成各类动画
            var css3Ani={
                fadeIn:JS2CSSKeyframes('fadeIn',['opacity:0','opacity:1']),
                fadeOut:JS2CSSKeyframes('fadeOut',['opacity:1','opacity:0']),
                scaleIn:JS2CSSKeyframes('scaleIn',['transform:scale(0)','transform:scale(1)']),
                scaleOut:JS2CSSKeyframes('scaleOut',['transform:scale(1)','transform:scale(0)']),
                flyTop:JS2CSSKeyframes('flyTop',['transform:translate(0,50px);opacity:0','transform:translate(0,0);opacity:1']),
                flyRight:JS2CSSKeyframes('flyRight',['transform:translate(50px,0);opacity:0','transform:translate(0,0);opacity:1']),
                flybottom:JS2CSSKeyframes('flybottom',['transform:translate(0,-50px);opacity:0','transform:translate(0,0);opacity:1']),
                flyLeft:JS2CSSKeyframes('flyLeft',['transform:translate(-50px,0);opacity:0','transform:translate(0,0);opacity:1'])
            };
            
            //x y轴翻转
            "X Y".split(" ").forEach(function(prop){
                css3Ani['flipin'+prop]=JS2CSSKeyframes('flipin'+prop,{
                        '0%':'transform:perspective(400px) rotate'+prop+'(90deg)',
                        '40%':'transform:perspective(400px) rotate'+prop+'(-10deg)',
                        '70%':'transform:perspective(400px) rotate'+prop+'(10deg)',
                        '100%':'transform:perspective(400px) rotate'+prop+'(0)'
                    });
            });
            
            //生成1s ease曲线执行的css类，如 .flyTop { -webkit-aniamtion: flyTop 1s ease; }
            Object.keys(css3Ani).forEach(function(name){
                styleSheet.insertRule('.'+name+'{ '+vendor+'animation: '+name+' 1s ease }',0);
            });
            
            "200 400 500 1000 1200 1500 2000 3000".split(" ").forEach(function(t){
                styleSheet.insertRule('.delay'+t+'{ '+vendor+'animation-delay: '+t+'ms; '+vendor+'animation-fill-mode: backwards }',0);
            });
            
            ROOT.css3Ani=css3Ani;

})(window);
    </pre>
</div>
<script type="text/javascript" src="src/j2ckf.js"></script>
<script type="text/javascript" src="css3-animation.js"></script>
<script type="text/javascript">
var fly=new JS2CSSKeyframes('fly',{
    from:'transform:translate(0,0)',
    to:'transform:translate(100px,0)'
});
document.querySelector('#pre1').appendChild(document.createTextNode('\n\nkeyframe内容：\n\n'+fly.cssText));

var ani1;
document.querySelector('#dot2').style.cssText=JS2CSSKeyframes.vendor+'animation:'+(ani1=JS2CSSKeyframes(['transform:translate(0,0)','transform:translate(100px,0)'])).name+' 1s linear alternate infinite';
document.querySelector('#pre2').appendChild(document.createTextNode('\n\nkeyframe内容：\n\n'+ani1.cssText));

var ani2,kfs=[],num=100,rand=function(f,t){return Math.random()*t+f}
while(num){
    kfs.push({transform:'translate('+(100-num)*5+'px,0)',background:'rgba('+parseInt(255*Math.random())+','+parseInt(255*Math.random())+','+parseInt(255*Math.random())+','+Math.random()+')'});
    num--;
}
document.querySelector('#dot3').style[JS2CSSKeyframes.animation]=(ani2=JS2CSSKeyframes(kfs)).name+' 30s linear alternate infinite';
document.querySelector('#pre3').appendChild(document.createTextNode('\n\nkeyframe内容：\n\n'+ani2.cssText));
</script>
</body>
</html>
